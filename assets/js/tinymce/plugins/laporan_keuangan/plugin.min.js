tinymce.PluginManager.add('laporan_keuangan', function( editor, url ) {
	editor.addButton( 'laporan_keuangan', {
		text: 'Laporan Keuangan',
		icon: false,
		type: 'menubutton',
		menu: [
			{
				text: 'Laporan Keuangan (Impor)',
				icon: 'link',
				type: 'menuitem',
				menu: [
					{
						text: 'Grafik Laporan Keuangan (Impor)',
						icon: 'resize',
						onclick: function() {
							var url = BASE_URL + "index.php/keuangan/cek_tahun";
							$.ajax({
								type: "GET",
								url: url,
								dataType: "json",
								processData: true,
								success: function (data) {
									editor.windowManager.open( {
										title: 'Pilih Tahun Laporan',
										body: [
											{
												type   : 'listbox',
												name   : 'tahun',
												label  : 'Tahun',
												values : data,
											},
										],
										onsubmit: function( e ) {
											editor.insertContent('[[grafik-RP-APBD,' + e.data.tahun +']]');
										},
										width: 400,
										height: 140
									} )
								},
								error: function (xhr, status, error) {
									alert("Error! " + xhr.status + "\n" + error);
									console.log(xhr);
								}
							});
						}
					},
					{
						text: 'Tabel Laporan Keuangan (Impor)',
						icon: 'table',
						type: 'menuitem',
						menu: [
							{
								text: 'Laporan Keuangan (Belanja per Kelompok)',
								onclick: function() {
									var url = BASE_URL + "index.php/keuangan/cek_tahun";
									$.ajax({
										type: "GET",
										url: url,
										dataType: "json",
										processData: true,
										success: function (data) {
											editor.windowManager.open( {
												title: 'Pilih Tahun Laporan',
												body: [
													{
														type   : 'listbox',
														name   : 'tahun',
														label  : 'Tahun',
														values : data,
													},
												],
												onsubmit: function( e ) {
													editor.insertContent('[[lap-RP-APBD,'+ e.data.tahun +']]');
												},
												width: 400,
												height: 140
											} )
										},
										error: function (xhr, status, error) {
											alert("Error! " + xhr.status + "\n" + error);
											console.log(xhr);
											console.log(base_url);
										}
									});
								}
							},
							{
								text: 'Laporan Keuangan (Belanja per Bidang)',
								onclick: function() {
									var url = BASE_URL + "index.php/keuangan/cek_tahun";
									$.ajax({
										type: "GET",
										url: url,
										dataType: "json",
										processData: true,
										success: function (data) {
											editor.windowManager.open( {
												title: 'Pilih Tahun Laporan',
												body: [
													{
														type   : 'listbox',
														name   : 'tahun',
														label  : 'Tahun',
														values : data,
													},
												],
												onsubmit: function( e ) {
													editor.insertContent('[[lap-RP-APBD-Bidang,'+ e.data.tahun +']]');
												},
												width: 400,
												height: 140
											} )
										},
										error: function (xhr, status, error) {
											alert("Error! " + xhr.status + "\n" + error);
											console.log(xhr);
											console.log(base_url);
										}
									});
								}
							}
						]
					}
				]
			},
			{
				text: 'Laporan Keuangan (Manual)',
				icon: 'line',
				type: 'menuitem',
				menu: [
					{
						text: 'Grafik Laporan Keuangan (Manual)',
						icon: 'resize',
						onclick: function() {
							var url = BASE_URL + "index.php/keuangan_manual/cek_tahun_manual";
							$.ajax({
								type: "GET",
								url: url,
								dataType: "json",
								processData: true,
								success: function (data) {
									editor.windowManager.open( {
										title: 'Pilih Tahun Laporan',
										body: [
											{
												type   : 'listbox',
												name   : 'tahun',
												label  : 'Tahun',
												values : data,
											},
										],
										onsubmit: function( e ) {
											editor.insertContent('[[grafik-RP-APBD-manual,' + e.data.tahun +']]');
										},
										width: 400,
										height: 140
									} )
								},
								error: function (xhr, status, error) {
									alert("Error! " + xhr.status + "\n" + error);
									console.log(xhr);
								}
							});
						}
					},
					{
						text: 'Tabel Laporan Keuangan (Manual)',
						icon: 'table',
						onclick: function() {
							var url = BASE_URL + "index.php/keuangan_manual/cek_tahun_manual";
							$.ajax({
								type: "GET",
								url: url,
								dataType: "json",
								processData: true,
								success: function (data) {
									editor.windowManager.open( {
										title: 'Pilih Tahun Laporan',
										body: [
											{
												type   : 'listbox',
												name   : 'tahun',
												label  : 'Tahun',
												values : data,
											},
										],
										onsubmit: function( e ) {
											editor.insertContent('[[lap-RP-APBD-Bidang-manual,' + e.data.tahun +']]');
										},
										width: 400,
										height: 140
									} )
								},
								error: function (xhr, status, error) {
									alert("Error! " + xhr.status + "\n" + error);
									console.log(xhr);
								}
							});
						}
					}
				]
			}
		]
	});
});
